[tox]
envlist =
    fmt-check
    lint
    type-check
    examples
    py{39, 38, 37}
isolated_build = true
skip_missing_interpreters = true

[testenv]
commands =
    {envpython} -bb -Werror -m pytest -p no:sugar {posargs}
install_dev_deps = true

[testenv:fmt-check]
skip_install = true
commands =
    isort --check-only .
    black --check .

[testenv:lint]
skip_install = true
commands =
    flake8

[testenv:type-check]
skip_install = true
commands =
    mypy {{cookiecutter.project_name}}

[testenv:examples]
skip_install = false
commands =
    python examples/album_example.py
    python examples/playlist_example.py
    python examples/track_example.py

[gh-actions]
python =
    3.7: py37
    3.8: py38, fmt-check, lint, type-check, examples
    3.9: py39

[flake8]
max-line-length = 99
exclude =
    .git
    .github
    .mypy_cache
    .pytest_cache
    .tox
    .vscode
    .venv
    build
    dist
    docs
    examples
    tests
    __pycache__
extend-ignore =
    E203,
    WPS431,
    Q000,
    WPS529,
    WPS110,
    N801,
    N805,
    WPS221,
    WPS226,
    WPS231,
    WPS609,
    WPS603,
    WPS437,
    WPS433,
    WPS412,
    WPS410,
    WPS323,
    D105,
    D106,
    RST,
    WPS436 # https://github.com/wemake-services/wemake-python-styleguide/issues/1441
